// Generated by CoffeeScript 1.10.0
var Client, Sharing, cozydb, sendAnswer, urlHelper;

cozydb = require('cozydb');

urlHelper = require('cozy-url-sdk');

Client = require('request-json').JsonClient;

module.exports = Sharing = cozydb.getModel('Sharing', {
  sharerUrl: String,
  desc: String,
  rules: [Object],
  continuous: Boolean,
  targets: Object,
  accepted: Boolean
});

Sharing.pendingBySharedDocType = function(docType, callback) {
  return Sharing.request('pendingBySharedDocType', {
    key: docType
  }, callback);
};

sendAnswer = function(data, callback) {
  var client;
  client = new Client(urlHelper.dataSystem.url());
  return client.post('services/sharing/sendAnswer', data, function(err, res, body) {
    if (err) {
      return callback(err, res);
    } else {
      return callback(null, this);
    }
  });
};

Sharing.accept = function(id, callback) {
  return sendAnswer({
    id: id,
    accepted: true
  }, callback);
};

Sharing.refuse = function(id, callback) {
  return sendAnswer({
    id: id,
    accepted: false
  }, callback);
};
